<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio-Roll: Master Archive</title>
    <style>
        :root { 
            --common: #95a5a6; --uncommon: #2ecc71; --rare: #3498db; 
            --legendary: #f1c40f; --mythic: #9b59b6; --god: #ff3e3e; 
            --shiny: #ff69b4; --doge: #ffcc00; --panel: rgba(15, 15, 15, 0.98);
        }
        
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        #flash { position: fixed; inset: 0; background: #fff; opacity: 0; pointer-events: none; z-index: 2000; transition: opacity 0.1s; }

        /* Layout Panels */
        .sidebar { width: 280px; background: var(--panel); border-right: 1px solid #222; padding: 20px; display: flex; flex-direction: column; overflow-y: auto; }
        .main-game { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; background: radial-gradient(circle at center, #111 0%, #000 100%); }
        .shop-panel { width: 300px; background: var(--panel); border-left: 1px solid #222; padding: 20px; overflow-y: auto; }

        /* Gallery Overlay */
        #gallery-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 1500;
            display: none; padding: 40px; overflow-y: auto; backdrop-filter: blur(15px);
        }
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; margin-top: 20px; }
        .gallery-card { 
            background: #111; border: 1px solid #222; border-radius: 12px; padding: 15px; 
            text-align: center; position: relative; transition: 0.3s;
        }
        .gallery-card.locked { opacity: 0.15; filter: grayscale(1); }
        .gallery-card.shiny-owned { border: 2px solid var(--shiny); box-shadow: 0 0 15px var(--shiny); }

        /* Stage Visuals */
        #display-stage { position: relative; width: 350px; height: 350px; display: flex; align-items: center; justify-content: center; }
        .skin-layer { position: absolute; font-size: 10rem; z-index: 5; filter: drop-shadow(0 0 10px rgba(0,0,0,0.5)); }
        .aura-layer { position: absolute; font-size: 14rem; opacity: 0.2; filter: blur(40px); animation: pulse 3s infinite alternate; }
        @keyframes pulse { from { transform: scale(0.9); opacity: 0.1; } to { transform: scale(1.15); opacity: 0.3; } }

        /* UI Components */
        .stat-card { background: rgba(255,255,255,0.03); border: 1px solid #333; border-radius: 10px; padding: 12px; margin-bottom: 10px; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 10px; cursor: pointer; font-weight: 800; transition: 0.2s; }
        .roll-btn { background: #fff; color: #000; font-size: 1.2rem; }
        .shop-btn { background: #27ae60; color: #fff; margin-top: 8px; font-size: 0.8rem; }
        .shop-btn:disabled { background: #333; opacity: 0.5; }

        .tag { font-size: 0.7rem; letter-spacing: 4px; font-weight: bold; opacity: 0.6; }
    </style>
</head>
<body>

<div id="flash"></div>

<div id="gallery-overlay">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h1 style="color:var(--rare)">BIOLOGICAL ARCHIVE</h1>
        <button class="btn" style="width:100px; background:#e74c3c; color:#fff" onclick="toggleGallery()">CLOSE</button>
    </div>
    <div id="gallery-content" class="gallery-grid"></div>
</div>

<div class="sidebar">
    <h3 class="tag">STATISTICS</h3>
    <div class="stat-card">
        <small style="color:#666">SAMPLES</small><br>
        <b id="total-rolls" style="font-size:1.4rem">0</b>
    </div>
    <div class="stat-card">
        <small style="color:#666">LUCK RATIO</small><br>
        <b id="luck-level" style="color:var(--uncommon)">1.0x</b>
    </div>
    
    <h3 class="tag" style="margin-top:20px;">COLLECTION</h3>
    <div id="inv-display" style="font-size: 0.85rem; line-height: 1.6;"></div>
    
    <button class="btn" style="background:#222; color:#fff; margin-top:auto;" onclick="toggleGallery()">ğŸ“– OPEN GALLERY</button>
</div>

<div class="main-game">
    <div id="display-stage">
        <div id="aura-layer" class="aura-layer"></div>
        <div id="skin-layer" class="skin-layer">ğŸ¥š</div>
    </div>
    <div id="rarity-tag" class="tag">INITIALIZING</div>
    <div id="animal-name" style="font-size: 2.5rem; font-weight: 900; margin: 10px 0;">BIO-ROLL</div>
    
    <div style="width: 300px;">
        <button class="btn roll-btn" onclick="roll()">ROLL SEQUENCE</button>
        <div style="display:flex; justify-content:center; gap:20px; margin-top:15px;">
            <label style="font-size: 0.7rem; color: #444; cursor:pointer;"><input type="checkbox" id="turbo"> TURBO</label>
            <span id="rolls-count" style="font-size: 0.7rem; color: #444;">ID: 000</span>
        </div>
    </div>
</div>

<div class="shop-panel">
    <h3 class="tag">EMPIRE SHOP</h3>
    <div class="stat-card">
        <b style="color:var(--legendary)">Mega Roll x50</b>
        <p style="font-size:0.7rem; color:#888;">Bulk roll 50 animals instantly.</p>
        <button class="btn shop-btn" onclick="bulkRoll(50)" id="mega-btn">Cost: 1 Rare</button>
    </div>
    <div class="stat-card">
        <b style="color:var(--rare)">Bio-Forge Rare</b>
        <p style="font-size:0.7rem; color:#888;">Craft 1 Rare animal.</p>
        <button class="btn shop-btn" onclick="craft('Rare')" id="forge-btn">Cost: 100 Common</button>
    </div>
    <div class="stat-card">
        <b style="color:var(--uncommon)">Luck Serum</b>
        <p style="font-size:0.7rem; color:#888;">Permanent +0.5 Luck.</p>
        <button class="btn shop-btn" onclick="buyLuck()" id="luck-btn">Cost: 50 Common</button>
    </div>
</div>

<script>
    const db = {
        Common: [
            {id:"c1", n:"Cat", e:"ğŸˆ", a:"ğŸ¾"}, {id:"c2", n:"Rat", e:"ğŸ€", a:"ğŸ§€"}, 
            {id:"c3", n:"Ant", e:"ğŸœ", a:"ğŸ‚"}, {id:"c4", n:"Snail", e:"ğŸŒ", a:"ğŸŒ±"},
            {id:"c5", n:"Fly", e:"ğŸª°", a:"ğŸ—‘ï¸"}, {id:"c6", n:"Bee", e:"ğŸ", a:"ğŸŒ»"}
        ],
        Uncommon: [
            {id:"u1", n:"Fox", e:"ğŸ¦Š", a:"âœ¨"}, {id:"u2", n:"Deer", e:"ğŸ¦Œ", a:"ğŸŒ²"},
            {id:"u3", n:"Owl", e:"ğŸ¦‰", a:"ğŸŒ™"}, {id:"u4", n:"Frog", e:"ğŸ¸", a:"ğŸ’§"}
        ],
        Rare: [
            {id:"r1", n:"DOGE", e:"ğŸ•", a:"ğŸ¦´"}, {id:"r2", n:"Shark", e:"ğŸ¦ˆ", a:"ğŸŒŠ"},
            {id:"r3", n:"Rex", e:"ğŸ¦–", a:"ğŸŒ‹"}, {id:"r4", n:"Lion", e:"ğŸ¦", a:"ğŸŒ…"}
        ],
        Legendary: [
            {id:"l1", n:"Phoenix", e:"ğŸ¦â€ğŸ”¥", a:"ğŸ”¥"}, {id:"l2", n:"Dragon", e:"ğŸ²", a:"âš¡"},
            {id:"l3", n:"Whale", e:"ğŸ‹", a:"ğŸŒŒ"}
        ],
        Mythic: [
            {id:"m1", n:"Glitch", e:"ğŸ‘¾", a:"â¬›"}, {id:"m2", n:"Reaper", e:"ğŸ’€", a:"ğŸŒ€"}
        ],
        God: [
            {id:"g1", n:"Supernova", e:"â˜€ï¸", a:"ğŸ’¥"}, {id:"g2", n:"Eternity", e:"ğŸ’", a:"âœ¨"}
        ]
    };

    let s = { 
        rolls: 0, luck: 1.0, inv: {Common:0, Uncommon:0, Rare:0, Legendary:0, Mythic:0, God:0},
        discovered: [], shinies: [] 
    };

    function roll(forcedTier = null) {
        s.rolls++;
        let t = "Common";
        if (forcedTier) {
            t = forcedTier;
        } else {
            let rng = Math.random() * 1000000;
            let luck = s.luck;
            if (rng < (2 * luck)) t = "God";
            else if (rng < (100 * luck)) t = "Mythic";
            else if (rng < (2000 * luck)) t = "Legendary";
            else if (rng < (40000 * luck)) t = "Rare";
            else if (rng < (200000 * luck)) t = "Uncommon";
        }

        s.inv[t]++;
        const pool = db[t];
        const pick = pool[Math.floor(Math.random() * pool.length)];
        let isShiny = (Math.random() * 100) < 2;

        if(!s.discovered.includes(pick.id)) s.discovered.push(pick.id);
        if(isShiny && !s.shinies.includes(pick.id)) s.shinies.push(pick.id);

        updateStage(t, pick, isShiny);
        updateUI();
        save();
    }

    function updateStage(t, p, shiny) {
        const aura = document.getElementById('aura-layer');
        const skin = document.getElementById('skin-layer');
        const name = document.getElementById('animal-name');
        const tag = document.getElementById('rarity-tag');

        aura.innerText = p.a;
        skin.innerText = p.e;
        skin.style.filter = shiny ? "drop-shadow(0 0 30px var(--shiny)) brightness(1.3)" : "none";
        
        name.innerText = (shiny ? "âœ¨ " : "") + p.n;
        name.style.color = `var(--${t.toLowerCase()})`;
        tag.innerText = t.toUpperCase();
        tag.style.color = `var(--${t.toLowerCase()})`;

        if(t === "God") {
            document.getElementById('flash').style.opacity = "1";
            setTimeout(()=> document.getElementById('flash').style.opacity = "0", 150);
        }
    }

    function updateUI() {
        document.getElementById('total-rolls').innerText = s.rolls.toLocaleString();
        document.getElementById('luck-level').innerText = s.luck.toFixed(1) + "x";
        document.getElementById('inv-display').innerHTML = Object.keys(s.inv).map(k => 
            `<div style="color:var(--${k.toLowerCase()})">${k}: ${s.inv[k]}</div>`
        ).join('');

        document.getElementById('mega-btn').disabled = s.inv.Rare < 1;
        document.getElementById('forge-btn').disabled = s.inv.Common < 100;
        document.getElementById('luck-btn').disabled = s.inv.Common < 50;
    }

    function toggleGallery() {
        const g = document.getElementById('gallery-overlay');
        const isOpening = g.style.display !== "block";
        g.style.display = isOpening ? "block" : "none";
        if(isOpening) {
            const content = document.getElementById('gallery-content');
            content.innerHTML = "";
            Object.values(db).flat().forEach(a => {
                const found = s.discovered.includes(a.id);
                const shiny = s.shinies.includes(a.id);
                content.innerHTML += `
                    <div class="gallery-card ${found?'':'locked'} ${shiny?'shiny-owned':''}">
                        <div style="font-size:2.5rem">${found ? a.e : '?'}</div>
                        <div style="font-size:0.6rem; margin-top:5px;">${found ? a.n : 'Unknown'}</div>
                    </div>`;
            });
        }
    }

    function bulkRoll(n) { if(s.inv.Rare >= 1) { s.inv.Rare--; for(let i=0; i<n; i++) roll(); } }
    function craft(tier) { if(s.inv.Common >= 100) { s.inv.Common -= 100; roll(tier); } }
    function buyLuck() { if(s.inv.Common >= 50) { s.inv.Common -= 50; s.luck += 0.5; updateUI(); } }

    let turbo;
    document.getElementById('turbo').onchange = (e) => {
        if(e.target.checked) turbo = setInterval(roll, 100);
        else clearInterval(turbo);
    };

    function save() { localStorage.setItem('bio_master_v1', JSON.stringify(s)); }
    function load() {
        const saved = localStorage.getItem('bio_master_v1');
        if(saved) { s = JSON.parse(saved); updateUI(); }
    }
    load();
</script>
</body>
</html>
