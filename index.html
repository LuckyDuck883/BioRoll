<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio-Roll: Infinite Collection</title>
    <style>
        :root { 
            --common: #ecf0f1; --uncommon: #2ecc71; --rare: #3498db; 
            --legendary: #f1c40f; --mythic: #9b59b6; --shiny: #ff69b4; 
            --bg: #0d0d0d; --panel: #1a1a1a;
        }
        body { background: var(--bg); color: #e0e0e0; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Sidebars */
        .sidebar-left { width: 280px; background: var(--panel); border-right: 2px solid #333; padding: 15px; display: flex; flex-direction: column; overflow-y: auto; }
        .main-game { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .sidebar-right { width: 280px; background: var(--panel); border-left: 2px solid #333; padding: 15px; overflow-y: auto; }

        /* Collection Book Styles */
        .book-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 10px; }
        .book-slot { 
            width: 50px; height: 50px; background: #222; border-radius: 8px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 1.5rem; border: 1px solid #333; position: relative;
        }
        .locked { filter: brightness(0) invert(0.2); }
        .book-slot:hover .tooltip { display: block; }
        .tooltip { 
            display: none; position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%);
            background: black; color: white; padding: 5px; border-radius: 5px; font-size: 0.7rem; z-index: 10; white-space: nowrap;
        }

        /* Central Game */
        #art-display { font-size: 9rem; margin: 10px; transition: 0.1s; }
        #name-display { font-size: 2.5rem; font-weight: 900; margin: 0; }
        .roll-btn { 
            width: 250px; padding: 20px; font-size: 1.5rem; background: #3498db; border: none; 
            border-radius: 50px; color: white; cursor: pointer; font-weight: bold;
            box-shadow: 0 6px 0 #21618c; margin-top: 20px;
        }
        .roll-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #21618c; }

        /* Shop */
        .shop-item { background: #222; border-radius: 12px; padding: 12px; margin-bottom: 12px; border: 1px solid #333; }
        .buy-btn { width: 100%; background: #27ae60; border: none; padding: 8px; border-radius: 5px; color: white; cursor: pointer; font-weight: bold; margin-top: 5px; }

        /* Rarity Colors */
        .Common { color: var(--common); } .Uncommon { color: var(--uncommon); }
        .Rare { color: var(--rare); } .Legendary { color: var(--legendary); } 
        .Mythic { color: var(--mythic); text-shadow: 0 0 20px var(--mythic); }
        .is-shiny { filter: drop-shadow(0 0 15px var(--shiny)); animation: shiny-glow 1s infinite alternate; }
        @keyframes shiny-glow { from { filter: hue-rotate(0deg) brightness(1); } to { filter: hue-rotate(90deg) brightness(1.3); } }
    </style>
</head>
<body>

<div class="sidebar-left">
    <h2 style="color:var(--rare); margin:0;">ğŸ“– BOOK</h2>
    <p style="font-size:0.7rem; color:#666;">Unlock all species</p>
    <div id="collection-grid" class="book-grid"></div>
    
    <div style="margin-top:20px; border-top: 1px solid #333; padding-top:15px;">
        <div style="font-size:0.8rem;">Luck: <span id="luck-val" style="color:var(--uncommon)">1.0</span>x</div>
        <div style="font-size:0.8rem;">Rolls: <span id="roll-val">0</span></div>
        <div style="font-size:0.8rem;">Shinies: <span id="shiny-val" style="color:var(--shiny)">0</span></div>
    </div>
</div>

<div class="main-game">
    <div id="rarity-label" style="letter-spacing:3px; color:#444;">DISCOVER LIFE</div>
    <div id="art-display">ğŸ¥š</div>
    <h1 id="name-display">???</h1>
    <button class="roll-btn" onclick="roll()">ROLL</button>
</div>

<div class="sidebar-right">
    <h2 style="color:var(--legendary); margin:0;">ğŸ›’ SHOP</h2>
    <div id="shop-container">
        <div class="shop-item">
            <b>ğŸ€ Luck Potion</b>
            <p style="font-size:0.7rem; color:#888;">Permanent +0.5 Luck</p>
            <button class="buy-btn" onclick="buy('luck', 30, 'Common')">30 Common</button>
        </div>
        <div class="shop-item">
            <b>ğŸ¤– Auto-Roller</b>
            <p style="font-size:0.7rem; color:#888;">Rolls every 1s</p>
            <button class="buy-btn" id="auto-btn" onclick="buyAuto()">15 Uncommon</button>
        </div>
        <div class="shop-item">
            <b>ğŸ§² Shiny Charm</b>
            <p style="font-size:0.7rem; color:#888;">+50% Shiny Chance</p>
            <button class="buy-btn" onclick="buy('shiny', 10, 'Rare')">10 Rare</button>
        </div>
    </div>
    <div id="inv-display" style="font-size:0.8rem; margin-top:20px; background:#111; padding:10px; border-radius:10px;"></div>
</div>

<script>
    const database = {
        Common: [{id:"c1", n:"Ant", a:"ğŸœ"}, {id:"c2", n:"Cat", a:"ğŸˆ"}, {id:"c3", n:"Rat", a:"ğŸ€"}, {id:"c4", n:"Snail", a:"ğŸŒ"}, {id:"c5", n:"Fish", a:"ğŸŸ"}],
        Uncommon: [{id:"u1", n:"Fox", a:"ğŸ¦Š"}, {id:"u2", n:"Owl", a:"ğŸ¦‰"}, {id:"u3", n:"Deer", a:"ğŸ¦Œ"}, {id:"u4", n:"Snake", a:"ğŸ"}, {id:"u5", n:"Bat", a:"ğŸ¦‡"}],
        Rare: [{id:"r1", n:"Lion", a:"ğŸ¦"}, {id:"r2", n:"Shark", a:"ğŸ¦ˆ"}, {id:"r3", n:"Eagle", a:"ğŸ¦…"}, {id:"r4", n:"Wolf", a:"ğŸº"}],
        Legendary: [{id:"l1", n:"Dragon", a:"ğŸ‰"}, {id:"l2", n:"Phoenix", a:"ğŸ”¥"}, {id:"l3", n:"Unicorn", a:"ğŸ¦„"}],
        Mythic: [{id:"m1", n:"Cthulhu", a:"ğŸ™"}, {id:"m2", n:"Glitch", a:"ğŸ‘¾"}, {id:"m3", n:"Galaxy", a:"ğŸŒ "}]
    };

    let s = {
        rolls: 0, luck: 1.0, shinies: 0, shinyRate: 100, auto: false,
        inv: { Common: 0, Uncommon: 0, Rare: 0, Legendary: 0, Mythic: 0 },
        unlocked: [] // IDs of animals found
    };

    function updateUI() {
        document.getElementById('roll-val').innerText = s.rolls;
        document.getElementById('luck-val').innerText = s.luck.toFixed(1);
        document.getElementById('shiny-val').innerText = s.shinies;
        if(s.auto) document.getElementById('auto-btn').innerText = "OWNED";
        
        // Update Inventory
        let invStr = "<b>INVENTORY:</b><br>";
        for(let key in s.inv) invStr += `<span class="${key}">${key}: ${s.inv[key]}</span><br>`;
        document.getElementById('inv-display').innerHTML = invStr;

        // Update Collection Book
        const grid = document.getElementById('collection-grid');
        grid.innerHTML = "";
        Object.values(database).flat().forEach(animal => {
            const isFound = s.unlocked.includes(animal.id);
            grid.innerHTML += `
                <div class="book-slot ${isFound ? '' : 'locked'}">
                    ${isFound ? animal.a : '?'}
                    <div class="tooltip">${isFound ? animal.n : '???'}</div>
                </div>`;
        });
    }

    function roll() {
        s.rolls++;
        let rng = Math.random() * 1000000;
        let t = "Common";
        if (rng < (1 * s.luck)) t = "Mythic";
        else if (rng < (300 * s.luck)) t = "Legendary";
        else if (rng < (8000 * s.luck)) t = "Rare";
        else if (rng < (180000 * s.luck)) t = "Uncommon";

        s.inv[t]++;
        const pick = database[t][Math.floor(Math.random() * database[t].length)];
        if(!s.unlocked.includes(pick.id)) s.unlocked.push(pick.id);
        
        let isShiny = (Math.random() * s.shinyRate) < 1;
        if(isShiny) s.shinies++;

        const art = document.getElementById('art-display');
        art.innerText = pick.a;
        art.className = (isShiny ? "is-shiny " : "") + t;
        document.getElementById('name-display').innerText = (isShiny ? "âœ¨ " : "") + pick.n;
        document.getElementById('name-display').className = t;
        document.getElementById('rarity-label').innerText = t;

        updateUI(); save();
    }

    function buy(type, cost, curr) {
        if(s.inv[curr] >= cost) {
            s.inv[curr] -= cost;
            if(type === 'luck') s.luck += 0.5;
            if(type === 'shiny') s.shinyRate /= 1.5;
            updateUI(); save();
        }
    }

    function buyAuto() {
        if(!s.auto && s.inv.Uncommon >= 15) {
            s.inv.Uncommon -= 15; s.auto = true;
            setInterval(roll, 1000); updateUI(); save();
        }
    }

    function save() { localStorage.setItem('bioRoll_v7', JSON.stringify(s)); }
    function load() {
        const saved = localStorage.getItem('bioRoll_v7');
        if(saved) { 
            s = JSON.parse(saved); 
            updateUI(); 
            if(s.auto) setInterval(roll, 1000);
        } else { updateUI(); }
    }

    load();
</script>
</body>
</html>
