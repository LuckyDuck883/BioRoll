<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio-Roll: Gallery Edition</title>
    <style>
        :root { 
            --common: #95a5a6; --uncommon: #2ecc71; --rare: #3498db; 
            --legendary: #f1c40f; --mythic: #9b59b6; --god: #ff3e3e; 
            --shiny: #ff69b4; --doge: #ffcc00; --panel: rgba(10, 10, 10, 0.95);
        }
        
        body { 
            background: #000; color: #fff; font-family: 'Inter', sans-serif; 
            margin: 0; display: flex; height: 100vh; overflow: hidden;
        }

        /* Flash & Overlays */
        #flash { position: fixed; inset: 0; background: #fff; opacity: 0; pointer-events: none; z-index: 1000; transition: opacity 0.1s; }
        
        /* Gallery Overlay */
        #gallery-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 500;
            display: none; padding: 50px; overflow-y: auto; backdrop-filter: blur(10px);
        }
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 15px; margin-top: 30px; }
        .gallery-item { background: #111; aspect-ratio: 1; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 2rem; border: 1px solid #222; position: relative; }
        .gallery-item.locked { opacity: 0.1; filter: grayscale(1); }
        .gallery-item.shiny-unlocked { border: 2px solid var(--shiny); box-shadow: 0 0 10px var(--shiny); }

        /* Panels */
        .sidebar { width: 280px; background: var(--panel); border-right: 1px solid #222; padding: 25px; display: flex; flex-direction: column; }
        .main-game { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }

        /* Visual Stage */
        #display-stage { position: relative; width: 380px; height: 380px; display: flex; align-items: center; justify-content: center; }
        .skin-layer { position: absolute; font-size: 11rem; z-index: 5; transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .aura-layer { position: absolute; font-size: 15rem; opacity: 0.3; filter: blur(30px); animation: pulse 4s ease-in-out infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.2; } 50% { transform: scale(1.1); opacity: 0.4; } }

        /* Buttons */
        .roll-btn { 
            width: 300px; padding: 20px; font-size: 1.5rem; font-weight: 800; border: none; border-radius: 15px;
            background: #fff; color: #000; cursor: pointer; transition: 0.2s;
        }
        .roll-btn:hover { background: #eee; transform: translateY(-2px); }
        .secondary-btn { background: #222; color: #fff; padding: 10px 20px; border-radius: 8px; border: 1px solid #333; cursor: pointer; margin-top: 10px; font-size: 0.8rem; }

        /* Rarity Classes */
        .is-shiny { filter: drop-shadow(0 0 25px var(--shiny)) brightness(1.2); }
        .God-Text { color: var(--god); text-shadow: 0 0 20px var(--god); font-weight: 900; }
    </style>
</head>
<body>

<div id="flash"></div>

<div id="gallery-overlay">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h1>ANIMAL GALLERY</h1>
        <button class="secondary-btn" onclick="toggleGallery()">CLOSE</button>
    </div>
    <div id="gallery-list" class="gallery-grid"></div>
</div>

<div class="sidebar">
    <h2 style="font-size: 0.8rem; color: #555; letter-spacing: 2px;">LOGS</h2>
    <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
        <small style="color:#666">TOTAL ROLLS</small>
        <div id="total-rolls" style="font-size: 1.5rem; font-weight: bold;">0</div>
    </div>
    
    <div id="inv-list" style="font-size: 0.8rem; flex-grow: 1;"></div>
    
    <button class="secondary-btn" onclick="toggleGallery()">ðŸ“– VIEW GALLERY</button>
</div>

<div class="main-game">
    <div id="display-stage">
        <div id="aura-layer" class="aura-layer"></div>
        <div id="skin-layer" class="skin-layer">ðŸ¥š</div>
    </div>
    <div id="rarity-tag" style="font-size: 0.7rem; letter-spacing: 5px; margin-top: 20px; color: #444;">IDLE</div>
    <div id="animal-name" style="font-size: 2.5rem; font-weight: 900; margin: 10px 0;">BIO-SCANNER</div>
    
    <button class="roll-btn" onclick="roll()">ROLL</button>
    <label style="margin-top: 15px; font-size: 0.7rem; color: #444; cursor: pointer;">
        <input type="checkbox" id="turbo"> TURBO MODE
    </label>
</div>

<script>
    const database = {
        Common: [
            {id:"c1", n:"Garden Snail", e:"ðŸŒ", a:"ðŸŒ±"}, {id:"c2", n:"Street Cat", e:"ðŸˆ", a:"ðŸ§¶"},
            {id:"c3", n:"Worker Bee", e:"ðŸ", a:"ðŸŒ»"}, {id:"c4", n:"Small Fish", e:"ðŸŸ", a:"ðŸ«§"}
        ],
        Uncommon: [
            {id:"u1", n:"Forest Fox", e:"ðŸ¦Š", a:"ðŸ‚"}, {id:"u2", n:"Tree Frog", e:"ðŸ¸", a:"ðŸ’§"},
            {id:"u3", n:"Blue Macaw", e:"ðŸ¦œ", a:"ðŸŒ´"}, {id:"u4", n:"Wild Wolf", e:"ðŸº", a:"â„ï¸"}
        ],
        Rare: [
            {id:"r1", n:"DOGE", e:"ðŸ•", a:"ðŸ¦´"}, {id:"r2", n:"Great White", e:"ðŸ¦ˆ", a:"ðŸŒŠ"},
            {id:"r3", n:"King Cobra", e:"ðŸ", a:"ðŸœï¸"}, {id:"r4", n:"T-Rex", e:"ðŸ¦–", a:"ðŸŒ‹"}
        ],
        Legendary: [
            {id:"l1", n:"Cyber Phoenix", e:"ðŸ¦â€ðŸ”¥", a:"ðŸ”¥"}, {id:"l2", n:"Hydra", e:"ðŸ", a:"ðŸ§ª"},
            {id:"l3", n:"Space Whale", e:"ðŸ‹", a:"ðŸŒŒ"}
        ],
        Mythic: [
            {id:"m1", n:"Glitch Entity", e:"ðŸ‘¾", a:"â¬›"}, {id:"m2", n:"Void Reaper", e:"ðŸ’€", a:"ðŸŒ€"}
        ],
        God: [
            {id:"g1", n:"SUPERNOVA", e:"â˜€ï¸", a:"ðŸ’¥"}, {id:"g2", n:"CELESTIAL", e:"ðŸ’Ž", a:"âœ¨"}
        ]
    };

    let s = { rolls: 0, luck: 1.0, inv: {}, unlocked: [], shinyUnlocked: [] };
    
    // Initialize inv
    Object.keys(database).forEach(k => s.inv[k] = 0);

    function roll() {
        s.rolls++;
        let rng = Math.random() * 1000000;
        let t = "Common";
        if (rng < (2 * s.luck)) t = "God";
        else if (rng < (150 * s.luck)) t = "Mythic";
        else if (rng < (2500 * s.luck)) t = "Legendary";
        else if (rng < (45000 * s.luck)) t = "Rare";
        else if (rng < (220000 * s.luck)) t = "Uncommon";

        s.inv[t]++;
        const pick = database[t][Math.floor(Math.random() * database[t].length)];
        let isShiny = (Math.random() * 100) < 2;

        if(!s.unlocked.includes(pick.id)) s.unlocked.push(pick.id);
        if(isShiny && !s.shinyUnlocked.includes(pick.id)) s.shinyUnlocked.push(pick.id);

        updateVisuals(t, pick, isShiny);
        updateUI();
        save();
    }

    function updateVisuals(t, p, shiny) {
        const aura = document.getElementById('aura-layer');
        const skin = document.getElementById('skin-layer');
        const name = document.getElementById('animal-name');
        const tag = document.getElementById('rarity-tag');

        aura.innerText = p.a;
        skin.innerText = p.e;
        skin.className = "skin-layer " + (shiny ? "is-shiny" : "");
        
        name.innerText = (shiny ? "âœ¨ " : "") + p.n;
        name.className = t === "God" ? "God-Text" : "";
        name.style.color = `var(--${t.toLowerCase()})`;

        tag.innerText = t.toUpperCase();
        tag.style.color = `var(--${t.toLowerCase()})`;

        if (t === "God") {
            document.getElementById('flash').style.opacity = "1";
            setTimeout(() => document.getElementById('flash').style.opacity = "0", 150);
        }
    }

    function toggleGallery() {
        const g = document.getElementById('gallery-overlay');
        g.style.display = g.style.display === "block" ? "none" : "block";
        if(g.style.display === "block") renderGallery();
    }

    function renderGallery() {
        const list = document.getElementById('gallery-list');
        list.innerHTML = "";
        Object.values(database).flat().forEach(a => {
            const found = s.unlocked.includes(a.id);
            const shinyFound = s.shinyUnlocked.includes(a.id);
            list.innerHTML += `
                <div class="gallery-item ${found ? '' : 'locked'} ${shinyFound ? 'shiny-unlocked' : ''}">
                    ${found ? a.e : '?'}
                </div>`;
        });
    }

    function updateUI() {
        document.getElementById('total-rolls').innerText = s.rolls.toLocaleString();
        let html = "";
        for(let k in s.inv) html += `<div style="color:var(--${k.toLowerCase()}); margin-bottom:4px;">${k}: ${s.inv[k]}</div>`;
        document.getElementById('inv-list').innerHTML = html;
    }

    let tInt;
    document.getElementById('turbo').onchange = (e) => {
        if(e.target.checked) tInt = setInterval(roll, 100);
        else clearInterval(tInt);
    };

    function save() { localStorage.setItem('bio_v10', JSON.stringify(s)); }
    function load() {
        const saved = localStorage.getItem('bio_v10');
        if(saved) { s = JSON.parse(saved); updateUI(); }
    }
    load();
</script>
</body>
</html>
